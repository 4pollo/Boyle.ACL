<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Item 属性</title>
<style type="text/css">
<!--
body { margin:0 auto; font-size:12px; line-height:150%; font-family:Verdana, Arial, Helvetica, sans-serif;}
a:link, a:active, a:visited {color: #0000FF;text-decoration: underline;}
a:hover {color: #0066FF;text-decoration: underline;}
ul, li { margin:0; padding:0; list-style:none; display:inline;}

	#header { width:100%; background-color:#9CF; border-bottom:1px solid #999;}
		#header .headertxt { padding:5px;}
	
	#main { width:96%; margin:0 auto; margin-top:20px;}
		#main #name { font-size:16px; color:#03F; border-bottom:2px solid #03F; padding-bottom:5px; margin-bottom:10px;}
		#main #content { font-size:14px; margin-bottom:20px;}
		#main .title, #footer .title { font-size:12px; font-weight:bold; color:#03F; }
		#main .code { padding:5px 30px;}
		#main .codem { color:#F60;}
		#main .codeparam { color:#666; font-style:italic;}
		#main .codetitle { color:#666; font-style:italic; width:1px; padding-right:5px;}
		#main .codetype { color:#666; font-style:italic;}
		#main .codenote { }
		#main .codeerror { color:#900;}
		#main td {padding:3px;}		
		#main .codetips { background-color:#F00; color:#FFF; padding:2px;}
		
		#wrong { float:right; text-align:right;}
		#wrong .codewrong{ background-color:#F00; color:#FFF; padding:2px 2px 4px;}
	
	#footer { width:96%; margin:0 auto; margin-top:10px;}
		#footer .nav { padding:5px 0; border-bottom:1px solid #999;}
		#footer .mail { padding:5px 0;}
		#footer .copyright { }
	
	/** NORMAL CODE HIGHLIGHT **/
	#normal { border:1px solid #ccc;}
	#normal .hcode { font-family: Courier New, Courier, monospace; line-height:19px; }
	#normal .hline { color:#333; font-style:italic; background-color:#ccc; border-right:3px solid #0C0; margin-right:8px; padding:2px 10px;}
	#normal .hacl { color:#F60;}
	#normal .hver { color:#00F;}
	#normal .hconst { color:#099;}
	#normal .hparam { color:#060;}
	#normal .hnumber { color:#F00;}
	#normal .hfunction { color:#906;}
	#normal .hnote { color:#999;}
	#normal .hresult { background-color:#000; color:#1dc116;}
	
	/** FADETOGREY HIGHLIGHT **/
	#fadetogrey { border:1px solid #000;}
	#fadetogrey .hcode { font-family: Courier New, Courier, monospace; line-height:19px; background-color:#121212; color:#FFF;}
	#fadetogrey .hline { color:#afafaf; font-style:italic;border-right:3px solid #36C; margin-right:8px; padding:2px 10px;}
	#fadetogrey .hacl { color:#F60;}
	#fadetogrey .hver { color:#d01d33;}
	#fadetogrey .hparam { color:#e3e658;}
	#fadetogrey .hnumber { color:#F00;}
	#fadetogrey .hfunction { color:#906;}
	#fadetogrey .hnote { color:#696854;}
-->
</style>
</head>

<body>
<div id="header"><div class="headertxt">Boyle.ACL 类库文档 (VBScript)</div></div>
<div id="main">
	<div id="name">System.Cache.Item 属性</div>
    <div id="content">存储和取回缓存</div>
<div id="method">
   	  <div class="title">语法</div>
        <div class="code"><span class="codem">System.Cache.Item</span>(<span class="codeparam">cacheName</span>)[ = <span class="codeparam">value</span>]</div>
    <div class="title">别名</div>
        <div class="code"><span class="codem">System.Cache</span>(<span class="codeparam">cacheName</span>)[ = <span class="codeparam">value</span>]</div>
  </div>
	<div id="param">
    	<div class="title">参数</div>
        <div class="code">
          <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr>
              <td class="codetitle">cacheName</td>
              <td class="codetype"> String (字符串)</td>
            </tr>
            <tr>
              <td class="codetitle">&nbsp;</td>
              <td class="codenote"> 缓存名称，同时也用于保存文件缓存时的文件名，不能包含 \*?&quot;&lt;&gt;| 等符号，但可以用 / 表示保存文件缓存时的目录结构。</td>
            </tr>
            <tr>
              <td class="codetitle">value</td>
              <td class="codetype"> Object (对象) 或 Recordset (记录集对象) 或 String (字符串) </td>
            </tr>
            <tr>
              <td class="codetitle">&nbsp;</td>
              <td class="codenote"> 要保存的缓存值。如果保存为文件缓存，则此项值可以是字符串和记录集；如果保存为内存缓存，则可以是字符串、记录集或者Dictionary等其它ASP对象。</td>
            </tr>
          </table>
        </div>
    </div>
	<div id="return">
    	<div class="title">返回值</div>
        <div class="code"><span class="codetype">Object (对象) 或 Recordset (记录集对象) 或 String (字符串)</span></div>
    </div>
	<div id="notes">
    	<div class="title">注释</div>
        <div class="code">缓存类使用两种方式保存缓存：</div>
        <div class="code"> 1.文件缓存，将缓存的值保存为文件，目前支持String(字符串)类型和Recordset(记录集对象)（使用相当于Recordset.Save）。 </div>
        <div class="code"> 存储方法为: <span class="codeparam">System.Cache.Item(&quot;CacheName&quot;).Save</span> 或 <span class="codeparam">System.Cache.SaveAll</span></div>
        <div class="code"> 2.内存缓存，将缓存保存到内存，请参考：<span class="codeparam">System.IO.CAS.SetApplication</span>。内存缓存 Recordset 对象时会自动转换为数组。 </div>
        <div class="code"> 存储方法为: <span class="codeparam">System.Cache.Item(&quot;CacheName&quot;).SaveApp</span> 或 <span class="codeparam">System.Cache.SaveAppAll</span></div>
        <div class="code"> 取出：<span class="codeparam"><em>Value</em> = System.Cache.Item(&quot;CacheName&quot;)</span> ，如果同时使用了内存和文件缓存，则优先读取内存中的值。 </div>
  </div>
	<div id="sample">
    	<div class="title">示例</div>
    	<div class="code">
    	  <div id="normal">
    	    <div class="hcode"><span class="hline">&nbsp;1.</span><span class="hnote">'// 创建一个新对象</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;2.</span><span class="hver">Dim</span> CacheX: <span class="hver">Set</span> CacheX = <span class="hacl">System.Cache.New</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;3.</span><span class="hnote">'// 设置缓存过期的时间，60表示60分钟</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;4.</span>CacheX.Expires = <span class="hnumber">60</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;5.</span><span class="hver">If</span> CacheX(<span class="hparam">"test/text"</span>).Ready <span class="hver">Then</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;6.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hacl">System.W</span> CacheX(<span class="hparam">"test/text"</span>)</div>
    	    <div class="hcode"><span class="hline">&nbsp;7.</span><span class="hver">Else</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;8.</span>&nbsp;&nbsp;&nbsp;&nbsp;CacheX(<span class="hparam">"test/text"</span>) = <span class="hparam">"要缓存的文本"</span></div>
    	    <div class="hcode"><span class="hline">&nbsp;9.</span>&nbsp;&nbsp;&nbsp;&nbsp;CacheX(<span class="hparam">"test/text"</span>).Save</div>
    	    <div class="hcode"><span class="hline">10.</span><span class="hver">End If</span></div>
    	    <div class="hcode"><span class="hline">11.</span><span class="hnote">'// 缓存某个 Recordset 对象，而不必每次查询数据库  </span></div>
    	    <div class="hcode"><span class="hline">12.</span><span class="hver">Dim</span> Rs: <span class="hver">If</span> CacheX(<span class="hparam">"test/rs"</span>).Ready <span class="hver">Then</span></div>
    	    <div class="hcode"><span class="hline">13.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hver">Set</span> Rs = CacheX("rs")</div>
    	    <div class="hcode"><span class="hline">14.</span><span class="hver">Else</span></div>
    	    <div class="hcode"><span class="hline">15.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hver">Set</span> Rs = <span class="hacl">System.Data.Query</span>(<span class="hparam">"SQL语句"</span>)</div>
    	    <div class="hcode"><span class="hline">16.</span>&nbsp;&nbsp;&nbsp;&nbsp;CacheX(<span class="hparam">"test/rs"</span>) = rs</div>
    	    <div class="hcode"><span class="hline">17.</span>&nbsp;&nbsp;&nbsp;&nbsp;CacheX(<span class="hparam">"test/rs"</span>).Save</div>
    	    <div class="hcode"><span class="hline">18.</span><span class="hver">End If</span></div>
    	    <div class="hcode"><span class="hline">19.</span><span class="hnote">'// 循环输出记录</span></div>
    	    <div class="hcode"><span class="hline">20.</span><span class="hver">Do While Not</span> Rs.<span class="hfunction">Eof</span></div>
    	    <div class="hcode"><span class="hline">21.</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hacl">System.WB</span> Rs(<span class="hnumber">0</span>)</div>
    	    <div class="hcode"><span class="hline">22.</span>&nbsp;&nbsp;&nbsp;&nbsp;Rs.<span class="hver">Movenext</span></div>
    	    <div class="hcode"><span class="hline">23.</span><span class="hver">Loop</span></div>
    	  </div>
  	  </div>
	</div>
</div>
<div id="footer">
  <div class="title">请参见</div>
	<div class="nav"><a href="index.html">System.Cache类</a>&nbsp;|&nbsp;<a href="../index.html">System.Common基类</a></div>
	<div class="mail"><a href="mailto:boyle7@qq.com">发送有关此主题的意见</a></div>
    <div class="copyright">Boyle.ACL v4.0.121028 类库文档. Copyright (C) 2006-2012 Boyle.</div>
</div>

</body>
</html>
